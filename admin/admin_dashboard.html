<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard</title>
    <!-- CDN for xlsx -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            fontFamily: {
              sans: ['Sarabun', 'sans-serif'],
            },
            colors: {
              primary: '#1E88E5', // Blue (Main Theme)
              secondary: '#E91E63', // Pink (Interaction/Accent)
            }
          }
        }
      }
    </script>
</head>
<body class="bg-blue-50 font-sans p-6 min-h-screen">

<div class="max-w-7xl mx-auto">
    <div class="flex justify-between items-center mb-8 bg-white p-6 rounded-xl shadow-md border-l-8 border-primary">
        <div>
            <h2 id="admin-name" class="text-2xl font-bold text-gray-800">Welcome, Admin</h2>
            <p class="text-sm text-gray-500">‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ú‡∏•‡∏™‡∏≠‡∏ö</p>
        </div>
        <button id="logout-btn" class="bg-red-50 text-red-600 hover:bg-red-100 px-4 py-2 rounded-lg font-medium transition duration-200 border border-red-200">Logout</button>
    </div>

    <!-- Form to add new student -->
    <div class="bg-white p-6 rounded-xl shadow-md mb-8 border-t-4 border-primary">
        <h3 class="text-lg font-bold text-primary mb-4 border-b pb-2">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÉ‡∏´‡∏°‡πà</h3>
        <form id="add-student-form">
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">‡∏£‡∏´‡∏±‡∏™‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô</label>
                    <input type="text" name="thID" required maxlength="13" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-secondary focus:border-transparent transition">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤</label>
                    <select name="prefix" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-secondary focus:border-transparent transition">
                        <option value="‡πÄ‡∏î‡πá‡∏Å‡∏ä‡∏≤‡∏¢">‡πÄ‡∏î‡πá‡∏Å‡∏ä‡∏≤‡∏¢</option>
                        <option value="‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á">‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á</option>
                        <option value="‡∏ô‡∏≤‡∏¢">‡∏ô‡∏≤‡∏¢</option>
                        <option value="‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß">‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">‡∏ä‡∏∑‡πà‡∏≠</label>
                    <input type="text" name="name" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-secondary focus:border-transparent transition">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label>
                    <input type="text" name="surname" required class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-secondary focus:border-transparent transition">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">‡∏£‡∏´‡∏±‡∏™‡∏ú‡∏π‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏≠‡∏ö</label>
                    <input type="text" name="studentID" required maxlength="8" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-secondary focus:border-transparent transition">
                </div>
                <div class="lg:col-span-2">
                    <label class="block text-sm font-medium text-gray-700 mb-1">‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</label>
                    <select name="study_plan" id="study-plan" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-secondary focus:border-transparent transition">
                        <option value="ISMT">‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå ‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå ‡πÅ‡∏•‡∏∞‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ</option>
                        <option value="ILEC">‡∏†‡∏≤‡∏©‡∏≤‡∏ï‡πà‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏® (‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏© - ‡∏à‡∏µ‡∏ô)</option>
                        <option value="IDGT">‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏î‡∏¥‡∏à‡∏¥‡∏ó‡∏±‡∏•</option>
                        <option value="IDGT + ISMT">‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå ‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå ‡πÅ‡∏•‡∏∞‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏î‡∏¥‡∏à‡∏¥‡∏ó‡∏±‡∏•</option>
                    </select>
                </div>
            </div>

            <!-- Score fields -->
            <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4 mb-6 bg-blue-50 p-4 rounded-lg border border-blue-100">
                <div id="math-section" class="hidden">
                    <label class="block text-sm font-medium text-gray-700 mb-1">‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå</label>
                    <input type="number" name="math" min="0" max="40" class="w-full px-3 py-2 border border-blue-200 rounded-md focus:outline-none focus:ring-2 focus:ring-secondary focus:border-transparent transition">
                </div>
                <div id="science-section" class="hidden">
                    <label class="block text-sm font-medium text-gray-700 mb-1">‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå</label>
                    <input type="number" name="science" min="0" max="60" class="w-full px-3 py-2 border border-blue-200 rounded-md focus:outline-none focus:ring-2 focus:ring-secondary focus:border-transparent transition">
                </div>
                <div id="english-section" class="hidden">
                    <label class="block text-sm font-medium text-gray-700 mb-1">‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©</label>
                    <input type="number" name="english" min="0" max="50" class="w-full px-3 py-2 border border-blue-200 rounded-md focus:outline-none focus:ring-2 focus:ring-secondary focus:border-transparent transition">
                </div>
                <div id="chinese-section" class="hidden">
                    <label class="block text-sm font-medium text-gray-700 mb-1">‡∏†‡∏≤‡∏©‡∏≤‡∏à‡∏µ‡∏ô</label>
                    <input type="number" name="chinese" min="0" max="40" class="w-full px-3 py-2 border border-blue-200 rounded-md focus:outline-none focus:ring-2 focus:ring-secondary focus:border-transparent transition">
                </div>
                <div id="social-section" class="hidden">
                    <label class="block text-sm font-medium text-gray-700 mb-1">‡∏™‡∏±‡∏á‡∏Ñ‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤</label>
                    <input type="number" name="social" min="0" max="60" class="w-full px-3 py-2 border border-blue-200 rounded-md focus:outline-none focus:ring-2 focus:ring-secondary focus:border-transparent transition">
                </div>
                <div id="thai-section" class="hidden">
                    <label class="block text-sm font-medium text-gray-700 mb-1">‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢</label>
                    <input type="number" name="thai" min="0" max="60" class="w-full px-3 py-2 border border-blue-200 rounded-md focus:outline-none focus:ring-2 focus:ring-secondary focus:border-transparent transition">
                </div>
                <div id="technology-section" class="hidden">
                    <label class="block text-sm font-medium text-gray-700 mb-1">‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ</label>
                    <input type="number" name="technology" min="0" max="80" class="w-full px-3 py-2 border border-blue-200 rounded-md focus:outline-none focus:ring-2 focus:ring-secondary focus:border-transparent transition">
                </div>
            </div>

            <input type="submit" value="‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô" class="bg-secondary hover:bg-pink-600 text-white font-bold py-2 px-6 rounded-lg cursor-pointer transition duration-200 shadow-md">
        </form>
    </div>

    <!-- Excel upload button and status -->
    <div class="mb-6 flex flex-wrap gap-4 items-center bg-white p-4 rounded-xl shadow-md border-l-4 border-gray-400">
        <button id="download-template-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-lg transition duration-200 flex items-center gap-2 shadow-sm">
            <span>üì•</span> ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á
        </button>
        <button id="upload-excel-btn" class="bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-4 rounded-lg transition duration-200 flex items-center gap-2 shadow-sm">
            <span>üìÑ</span> ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå Excel
        </button>
        <input type="file" id="excel-file" accept=".xlsx" style="display: none;">
        <div id="upload-status" class="text-sm text-gray-600"></div>
    </div>

    <!-- Search and table -->
    <div class="bg-white p-6 rounded-xl shadow-md">
        <div class="flex gap-2 mb-4">
            <input type="text" id="search-input" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô..." class="flex-1 px-4 py-2 border border-blue-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-secondary focus:border-transparent transition">
            <button id="search-btn" class="bg-secondary hover:bg-pink-700 text-white font-medium py-2 px-6 rounded-lg transition duration-200 shadow-sm">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</button>
        </div>
        
        <div class="overflow-x-auto rounded-lg border border-gray-100">
            <table class="min-w-full text-sm">
                <thead>
                    <tr class="bg-blue-50 text-gray-700 uppercase text-xs leading-normal">
                        <th class="py-3 px-4 text-left font-bold border-b-2 border-primary">‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
                        <th class="py-3 px-4 text-left font-bold border-b-2 border-primary">‡∏£‡∏´‡∏±‡∏™‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô</th>
                        <th class="py-3 px-4 text-left font-bold border-b-2 border-primary">‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</th>
                        <th class="py-3 px-4 text-left font-bold border-b-2 border-primary">‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤</th>
                        <th class="py-3 px-4 text-left font-bold border-b-2 border-primary">‡∏ä‡∏∑‡πà‡∏≠</th>
                        <th class="py-3 px-4 text-left font-bold border-b-2 border-primary">‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</th>
                        <th class="py-3 px-4 text-left font-bold border-b-2 border-primary">‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</th>
                        <th class="py-3 px-4 text-left text-center border-b-2 border-secondary">‡∏Ñ‡∏ì‡∏¥‡∏ï</th>
                        <th class="py-3 px-4 text-left text-center border-b-2 border-secondary">‡∏ß‡∏¥‡∏ó‡∏¢‡πå</th>
                        <th class="py-3 px-4 text-left text-center border-b-2 border-secondary">‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©</th>
                        <th class="py-3 px-4 text-left text-center border-b-2 border-secondary">‡∏™‡∏±‡∏á‡∏Ñ‡∏°</th>
                        <th class="py-3 px-4 text-left text-center border-b-2 border-secondary">‡∏à‡∏µ‡∏ô</th>
                        <th class="py-3 px-4 text-left text-center border-b-2 border-secondary">‡πÑ‡∏ó‡∏¢</th>
                        <th class="py-3 px-4 text-left text-center border-b-2 border-secondary">‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô</th>
                        <th class="py-3 px-4 text-left text-center font-bold border-b-2 border-pink-400 bg-pink-50">‡∏£‡∏ß‡∏°</th>
                        <th class="py-3 px-4 text-left border-b-2 border-gray-300">‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                    </tr>
                </thead>
                <tbody id="student-table" class="text-gray-700 text-sm font-light [&>tr]:border-b [&>tr]:border-gray-200 [&>tr:hover]:bg-blue-50 [&>tr>td]:py-3 [&>tr>td]:px-4 [&>tr>td]:whitespace-nowrap">
                    <!-- Data will be populated by JavaScript -->
                </tbody>
            </table>
        </div>
    </div>
</div>

<footer class="mt-8 text-center text-gray-400 text-sm pb-8">
    <p>¬© 2026 Triamudom suksanomklao Nokronratchsima Powered by Intensive Digital Technology : IDGT</p>
</footer>

<!-- Load Firebase and Dashboard scripts -->
<script type="module" src="./firebase.js"></script>
<script type="module" src="./dashboard.js"></script>

</body>
</html>